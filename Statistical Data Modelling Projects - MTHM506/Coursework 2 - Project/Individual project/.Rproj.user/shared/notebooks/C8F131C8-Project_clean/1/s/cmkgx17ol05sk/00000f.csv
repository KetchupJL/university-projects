"0","# Final Tweedie GAM model"
"0","set.seed(123)"
"0","gam_model_tw <- gam(TB ~ "
"0","                   Year + "
"0","                   Indigenous + "
"0","                   s(Urbanisation) +"
"0","                   s(Density) +"
"0","                   s(Unemployment) +"
"0","                   s(Poor_Sanitation) +"
"0","                   s(Poverty) +"
"0","                   s(Timeliness) +"
"0","                   s(lon,lat) +"
"0","                   offset(logPop),"
"0","                 data = TBdata, "
"0","                 family = tw, "
"0","                 method = ""REML"","
"0","                 select=TRUE)"
"0",""
"0","k.check(gam_model_tw)"
"1","                  "
"1"," k'"
"1","       edf"
"1","   k-index"
"1"," p-value"
"1","
s(Urbanisation)   "
"1","  9"
"1","  6.191294"
"1"," 0.5246709"
"1","       0"
"1","
s(Density)        "
"1","  9"
"1","  3.096894"
"1"," 0.5203579"
"1","       0"
"1","
s(Unemployment)   "
"1","  9"
"1","  4.661098"
"1"," 0.5275125"
"1","       0"
"1","
s(Poor_Sanitation)"
"1","  9"
"1","  5.516808"
"1"," 0.5181694"
"1","       0"
"1","
s(Poverty)        "
"1","  9"
"1","  4.615654"
"1"," 0.5288610"
"1","       0"
"1","
s(Timeliness)     "
"1","  9"
"1","  3.805945"
"1"," 0.5813806"
"1","       0"
"1","
s(lon,lat)        "
"1"," 29"
"1"," 24.694337"
"1"," 0.4894340"
"1","       0"
"1","
"
"0","summary(gam_model_tw)"
"1","
Family:"
"1"," "
"1","Tweedie(p=1.666)"
"1"," "
"1","
"
"1","Link function:"
"1"," "
"1","log"
"1"," "
"1","

"
"1","Formula:
"
"1","TB ~ Year + Indigenous + s(Urbanisation) + s(Density) + s(Unemployment) + 
"
"1","    s(Poor_Sanitation) + s(Poverty) + s(Timeliness) + s(lon, 
"
"1","    lat) + offset(logPop)
"
"1","
Parametric coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1","  t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -8.439363"
"1","   0.017281"
"1"," -488.367"
"1","  < 2e-16"
"1"," ***"
"1","
Year2013   "
"1"," -0.000324"
"1","   0.023324"
"1","   -0.014"
"1"," 0.988918"
"1","    "
"1","
Year2014   "
"1"," -0.040093"
"1","   0.023385"
"1","   -1.714"
"1"," 0.086631"
"1"," .  "
"1","
Indigenous "
"1","  0.015384"
"1","   0.004297"
"1","    3.580"
"1"," 0.000354"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","Approximate significance of smooth terms:
"
"1","                  "
"1","    edf"
"1"," Ref.df"
"1","      F"
"1","  p-value"
"1","    "
"1","
s(Urbanisation)   "
"1","  6.191"
"1","      9"
"1","  7.182"
"1","  < 2e-16"
"1"," ***"
"1","
s(Density)        "
"1","  3.097"
"1","      9"
"1","  3.364"
"1","  < 2e-16"
"1"," ***"
"1","
s(Unemployment)   "
"1","  4.661"
"1","      9"
"1","  9.638"
"1","  < 2e-16"
"1"," ***"
"1","
s(Poor_Sanitation)"
"1","  5.517"
"1","      9"
"1","  6.485"
"1","  < 2e-16"
"1"," ***"
"1","
s(Poverty)        "
"1","  4.616"
"1","      9"
"1","  3.768"
"1"," 4.15e-07"
"1"," ***"
"1","
s(Timeliness)     "
"1","  3.806"
"1","      9"
"1","  6.304"
"1","  < 2e-16"
"1"," ***"
"1","
s(lon,lat)        "
"1"," 24.694"
"1","     29"
"1"," 18.592"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","R-sq.(adj) = "
"1"," "
"1","0.902"
"1"," "
"1","  "
"1","Deviance explained = "
"1",""
"1","59.7"
"1",""
"1","%"
"1","
"
"1","-REML"
"1",""
"1"," = "
"1",""
"1","7122.6"
"1","  Scale est. = "
"1",""
"1","0.57508 "
"1",""
"1","  n = "
"1",""
"1","1671"
"1",""
"1","
"
"0","# plot(gam_model_tw, pages = 1, all.terms = TRUE, shade = TRUE)"
"0",""
"0","# Generate predicted TB cases from the GAM"
"0","TBdata$predicted_cases <- predict(gam_model_tw, type = ""response"")"
"0",""
"0","# Convert to TB rate per 100,000 population"
"0","TBdata$predicted_rate <- (TBdata$predicted_cases / TBdata$Population) * 100000"
"0",""
